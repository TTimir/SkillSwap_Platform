@using Markdig
@using System.Text.RegularExpressions
@using System.Text.Encodings.Web
@model SkillSwap_Platform.Services.Blogs.BlogDetailsVM

@{
    ViewData["Title"] = Model.Post.Title;
    Layout = "~/Views/Shared/_Layout.cshtml";

    string RenderContent(string mdText)
        => Markdown.ToHtml(mdText ?? "");
}

<section class="breadcumb-section">
    <div class="container">
        <div class="row">
            <div class="col-lg-12">
                <div class="breadcumb-style1">
                    <div class="breadcumb-list">
                        <a href="@Url.Action("Index","Home")">Home</a>
                        <a href="@Url.Action("Feed","Blog")">News &amp; Tips</a>
                        <a>@Model.Post.Title</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Blog Section Area -->
<section class="our-blog pt40">
    <div class="container">
        <div class="row wow fadeInUp" data-wow-delay="100ms">
            <div class="col-lg-12">
                <h2 class="blog-title">@Model.Post.Title</h2>
                <div class="blog-single-meta">
                    <div class="post-author d-sm-flex align-items-center">
                        <img class="mr10 me-2" src="@(Url.Content("~/template_assets/images/SS-Dark.png"))" alt="@Model.Post.Title" style="max-width: 100%;width: 40px;border-radius: 100%;" />
                        <a class="pr15 body-light-color" href="#">Swapo Author</a>
                        <a class="ml15 pr15 body-light-color" href="#">
                            @Model.Post.CreatedAt.ToLocalTime().ToString("MMMM d, yyyy")
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="mx-auto maxw1600 mt60 wow fadeInUp" data-wow-delay="300ms">
        <div class="row">
            <div class="col-lg-12">
                @if (!string.IsNullOrEmpty(Model.Post.CoverImagePath))
                {
                    <div class="large-thumb">
                        <img class="w-100 bdrs16" src="@Url.Content($"~/{Model.Post.CoverImagePath.TrimStart('/')}")"
                             alt="Cover for @Model.Post.Title" />
                    </div>
                }
            </div>
        </div>
    </div>

    <div class="container">
        <div class="row wow fadeInUp" data-wow-delay="500ms">
            <div class="col-xl-8 offset-xl-2">
                <div class="ui-content mt45 mb60 blog-content">
                    @Html.Raw(RenderContent(Model.Post.Content))
                </div>

                @if (Model.Post.Tags?.Any() == true)
                {
                    <div class="bsp_tags d-flex mb60">
                        @foreach (var tag in Model.Post.Tags)
                        {
                            <a class="mr10" href="@Url.Action("Feed","Blog", new { tag = tag })">@tag</a>
                        }
                    </div>
                }
            </div>
        </div>
    </div>
</section>