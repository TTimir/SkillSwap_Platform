@{
    ViewData["Title"] = "Confirm Email Change";
    Layout = null;

    // These will be set by the controller
    bool showOtpStep = (TempData["ShowOtpStep"] as bool?) ?? false;
    string newEmail = TempData["NewEmail"] as string ?? "";
    string infoMsg = TempData["InfoMessage"] as string;
    string errorMsg = TempData["ErrorMessage"] as string;
}

<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="keywords" content="bidding, fiverr, freelance marketplace, freelancers, freelancing, gigs, hiring, job board, job portal, job posting, jobs marketplace, peopleperhour, proposals, sell services, upwork">
    <meta name="description" content="Freeio - Freelance Marketplace HTML Template">
    <meta name="CreativeLayers" content="ATFN">
    <!-- css file -->
    <link rel="stylesheet" href="/template_assets/css/bootstrap.min.css">
    <link rel="stylesheet" href="/template_assets/css/ace-responsive-menu.css">
    <link rel="stylesheet" href="/template_assets/css/menu.css">
    <link rel="stylesheet" href="/template_assets/css/fontawesome.css">
    <link rel="stylesheet" href="/template_assets/css/flaticon.css">
    <link rel="stylesheet" href="/template_assets/css/bootstrap-select.min.css">
    <link rel="stylesheet" href="/template_assets/css/ud-custom-spacing.css">
    <link rel="stylesheet" href="/template_assets/css/animate.css">
    <link rel="stylesheet" href="/template_assets/css/jquery-ui.min.css">
    <link rel="stylesheet" href="/template_assets/css/slider.css">
    <link rel="stylesheet" href="/template_assets/css/style.css">
    <!-- Responsive stylesheet -->
    <link rel="stylesheet" href="/template_assets/css/responsive.css">
    <!-- Title -->
    <title>@ViewData["Title"] - SkillSwap</title>
    <!-- Favicon -->
    <link href="/template_assets/images/favicon.ico" sizes="128x128" rel="shortcut icon" type="image/x-icon" />
    <!-- Apple Touch Icon -->
    <link href="/template_assets/images/apple-touch-icon-60x60.png" sizes="60x60" rel="apple-touch-icon">
    <link href="/template_assets/images/apple-touch-icon-72x72.png" sizes="72x72" rel="apple-touch-icon">
    <link href="/template_assets/images/apple-touch-icon-114x114.png" sizes="114x114" rel="apple-touch-icon">
    <link href="/template_assets/images/apple-touch-icon-180x180.png" sizes="180x180" rel="apple-touch-icon">

    <!-- Custome Style -->
    <style>
        .text-danger ul {
            list-style-type: disc !important;
            margin-left: 20px;
            margin-bottom: 10px;
            font-size: 14px;
        }

        .header-logo.logo1 {
            display: inline-flex;
            align-items: center; /* vertical centering */
            justify-content: center; /* horizontal centering */
            color: #222;
            text-decoration: none;
            gap: 6px; /* small space between img and text */
        }

            .header-logo.logo1 img {
                border-radius: 14px;
                width: 40px;
                height: auto;
            }

            .header-logo.logo1 .logo-text {
                font-family: monospace;
                font-size: 22px;
                letter-spacing: 1;
                font-weight: 600;
                white-space: nowrap;
            }
    </style>
</head>
<body class="bgc-thm4">
    <div class="wrapper ovh">
        <div class="preloader"></div>

        <!-- Main Header Nav -->
        <header class="header-nav nav-innerpage-style main-menu">
            <!-- Ace Responsive Menu -->
            <nav class="posr">
                <div class="container-fluid posr menu_bdrt1">
                    <div class="row align-items-center justify-content-between">
                        <div class="col-auto pe-0">
                            <div class="d-flex align-items-center">
                                <a class="header-logo logo1" href="@Url.Action("Index","Home")">
                                    <img src="~/template_assets/images/header-logo-dark.png" alt="Header Logo" />
                                    <span class="logo-text">
                                        SkillSwap<span style="color:#5BBB7B">.</span>
                                    </span>
                                </a>
                            </div>
                        </div>
                        <div class="col-auto">
                            <div class="d-flex align-items-center">
                                <!-- Responsive Menu Structure-->
                                <ul id="respMenu" class="ace-responsive-menu" data-menu-style="horizontal">
                                    <li class="visible_list">
                                        <a class="list-item" href="#"><span class="title">Home</span></a>
                                    </li>
                                    <li class="visible_list">
                                        <a class="list-item" href="#"><span class="title">Services</span></a>
                                    </li>
                                    <li class="visible_list">
                                        <a class="list-item" href="#"><span class="title">How It Works</span></a>
                                    </li>
                                    <li class="visible_list">
                                        <a class="list-item" href="#"><span class="title">About us</span></a>
                                    </li>
                                    <li> <a class="list-item pe-0" href="page-contact.html">Contact</a></li>
                                </ul>
                                <!-- Separator Icon (You can change the icon class as needed) -->

                                @* <a class="login-info bdrl1 pl15-lg pl30" data-bs-toggle="modal" href="#exampleModalToggle" role="button"><span class="flaticon-loupe"></span></a> *@
                                <a class="ud-btn btn-thm mx15-lg mx30" href="page-become-seller.html"><span class="d-none d-xl-inline-block">Become a</span> Seller</a>
                                @*  <a class="login-info mr15-lg mr30" href="page-login.html">Sign in</a>
                                <a class="ud-btn btn-thm add-joining" href="page-register.html">Join</a> *@
                            </div>
                        </div>
                    </div>
                </div>
            </nav>
        </header>

        <div class="hiddenbar-body-ovelay"></div>

        <!-- Mobile Nav  -->
        <div id="page" class="mobilie_header_nav stylehome1">
            <div class="mobile-menu">
                <div class="header bdrb1">
                    <div class="menu_and_widgets">
                        <div class="mobile_menu_bar d-flex justify-content-between align-items-center">
                            <a class="mobile_logo" href="#"><img src="/template_assets/images/header-logo-dark.svg" alt=""></a>
                            <div class="right-side text-end">
                                <a class="" href="page-login.html">join</a>
                                <a class="menubar ml30" href="#menu"><img src="/template_assets/images/mobile-dark-nav-icon.svg" alt=""></a>
                            </div>
                        </div>
                    </div>
                    <div class="posr"><div class="mobile_menu_close_btn"><span class="far fa-times"></span></div></div>
                </div>
            </div>
            <!-- /.mobile-menu -->
            <nav id="menu" class="">
                <ul>
                    <li>
                        <a class="list-item" href="@Url.ActionLink("Index","Home")"><span class="title">Home</span></a>
                    </li>
                    <!-- Only for Mobile View -->
                </ul>
            </nav>
        </div>

        <div class="body_content">
            <!-- Our LogIn Area -->
            <section class="our-login">
                <div class="container">
                    <div class="row">
                        <div class="col-lg-6 m-auto wow fadeInUp" data-wow-delay="300ms">
                            <div class="main-title text-center">
                                <h2 class="title">Change Email Address</h2>
                                <p class="paragraph">Enter your new email below. We’ll send a confirmation code to verify it.</p>
                            </div>
                        </div>
                    </div>
                    <div class="row wow fadeInRight" data-wow-delay="300ms">
                        <div class="col-xl-6 mx-auto">
                            <div class="log-reg-form search-modal form-style1 bgc-white p50 p30-sm default-box-shadow1 bdrs12">
                                <div class="mb30">
                                    <small>Enter the one-time code we just sent to your new email address.</small>
                                </div>
                                @if (!string.IsNullOrEmpty(infoMsg))
                                {
                                    <div class="message-alart-style1">
                                        <div class="alert alart_style_one alert-dismissible fade show mb20" role="alert">
                                            Info: @infoMsg
                                            <i class="far fa-xmark btn-close" data-bs-dismiss="alert" aria-label="Close"></i>
                                        </div>
                                    </div>
                                }
                                @if (!string.IsNullOrEmpty(errorMsg))
                                {
                                    <div class="message-alart-style1">
                                        <div class="alert alart_style_three alert-dismissible fade show mb20" role="alert">
                                            @errorMsg
                                            <i class="far fa-xmark btn-close" data-bs-dismiss="alert" aria-label="Close"></i>
                                        </div>
                                    </div>
                                }
                                @if (!showOtpStep)
                                {
                                    @* — STEP 1: enter new email — *@
                                    @using (Html.BeginForm("SendEmailChangeCode", "UserProfile", FormMethod.Post))
                                    {
                                        @Html.AntiForgeryToken()
                                        <div class="mb-3">
                                            <label class="form-label">New Email</label>
                                            <input type="email" name="newEmail" class="form-control" placeholder="your@gmail.com" required />
                                        </div>
                                        <button type="submit" class="ud-btn btn-thm w-100">Send Code</button>
                                    }
                                }
                                else
                                {
                                    @* — STEP 2: enter OTP — *@
                                    <p>We sent a code to <strong>@newEmail</strong>. Enter it below:</p>
                                    @using (Html.BeginForm("ConfirmEmailChange", "UserProfile", FormMethod.Post))
                                    {
                                        @Html.AntiForgeryToken()
                                        <div class="mb-3">
                                            <label class="form-label">One-Time Code</label>
                                            <input type="text" name="otp" class="form-control" required />
                                        </div>
                                        <button type="submit" class="ud-btn btn-thm w-100">Verify Code</button>
                                    }
                                    <div class="text-center mt-2">
                                        Didn’t get it?
                                        @using (Html.BeginForm("SendEmailChangeCode", "UserProfile", FormMethod.Post, new { @class = "d-inline" }))
                                        {
                                            @Html.AntiForgeryToken()
                                            <input type="hidden" name="newEmail" value="@newEmail" />
                                            <button type="submit" class="btn btn-link p-0">Resend code</button>
                                        }
                                    </div>
                                }
                            </div>
                        </div>
                    </div>
                </div>
            </section>
            <!-- Our LogUp Area End -->
            <!-- Our Footer -->
            <section class="footer-style1 at-home2 pb-0 pt60">
                <div class="container white-bdrt1 py-4">
                    <div class="row">
                        <div class="col-sm-6">
                            <div class="text-center text-lg-start">
                                <p class="copyright-text mb-2 mb-md-0 text-white-light ff-heading">© SkillSwap. 2025 DsignGrid. All rights reserved.</p>
                            </div>
                        </div>
                        @* <div class="col-sm-6">
                            <div class="footer_bottom_right_btns at-home9 text-center text-lg-end">
                                <ul class="p-0 m-0">
                                    <li class="list-inline-item">
                                        <select class="selectpicker show-tick">
                                            <option>US$ USD</option>
                                            <option>Euro</option>
                                            <option>Pound</option>
                                        </select>
                                    </li>
                                    <li class="list-inline-item">
                                        <select class="selectpicker show-tick">
                                            <option>English</option>
                                            <option>Frenc</option>
                                            <option>Italian</option>
                                            <option>Spanish</option>
                                            <option>Turkey</option>
                                        </select>
                                    </li>
                                </ul>
                            </div>
                        </div> *@
                    </div>
                </div>
            </section>
        </div>
    </div>
    <!-- Wrapper End -->
    <script src="/template_assets/js/jquery-3.6.4.min.js"></script>
    <script src="/template_assets/js/jquery-migrate-3.0.0.min.js"></script>
    <script src="/template_assets/js/popper.min.js"></script>
    <script src="/template_assets/js/bootstrap.min.js"></script>
    <script src="/template_assets/js/bootstrap-select.min.js"></script>
    <script src="/template_assets/js/jquery.mmenu.all.js"></script>
    <script src="/template_assets/js/ace-responsive-menu.js"></script>
    <script src="/template_assets/js/jquery-scrolltofixed-min.js"></script>
    <script src="/template_assets/js/wow.min.js"></script>
    <!-- Custom script for all pages -->
    <script src="/template_assets/js/script.js"></script>
</body>
</html>
